<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>AR Image Switch</title>

<!-- A-Frame -->
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>

<!-- AR.js -->
<script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

<style>
  body {
    margin: 0;
    overflow: hidden;
  }

 /* 2Dボタン：サイバーホログラム・スタイル */
#nextBtn2D {
  position: fixed;
  bottom: 30px;
  right: 30px;
  
  /* フォント設定 */
  font-family: 'Consolas', 'Courier New', monospace;
  font-size: 14px;
  font-weight: bold;
  letter-spacing: 2px;
  text-transform: uppercase;
  
  /* 配色と透過（グラス風） */
  color: #00f2ff;
  background: rgba(0, 242, 255, 0.1);
  backdrop-filter: blur(4px); /* 背景をぼかす */
  
  /* 枠線と発光 */
  border: 1px solid #00f2ff;
  box-shadow: 0 0 15px rgba(0, 242, 255, 0.4), inset 0 0 10px rgba(0, 242, 255, 0.2);
  
  /* サイバーパンクな形状（右下を削ったデザイン） */
  padding: 15px 30px;
  clip-path: polygon(0% 0%, 100% 0%, 100% 70%, 85% 100%, 0% 100%);
  
  cursor: pointer;
  z-index: 9999;
  transition: all 0.2s ease;
  outline: none;
}

/* ホバー（触れた時）の演出 */
#nextBtn2D:hover {
  background: rgba(0, 242, 255, 0.3);
  box-shadow: 0 0 25px rgba(0, 242, 255, 0.8);
  transform: translateY(-2px);
  color: #fff;
}

/* アクティブ（クリックした瞬間） */
#nextBtn2D:active {
  transform: scale(0.95);
  background: #00f2ff;
  color: #000;
}

/* 装飾用の小さな四角をボタンの横に添える（オプション） */
#nextBtn2D::before {
  content: "DATA_NEXT";
  position: absolute;
  top: -18px;
  left: 0;
  font-size: 9px;
  color: #00f2ff;
  opacity: 0.7;
}
</style>
</head>

<body>

<a-scene
  embedded
  arjs="sourceType: webcam; debugUIEnabled: false;"
  vr-mode-ui="enabled: false"
>

  <a-assets id="assets"></a-assets>

  <a-marker
    id="marker"
    type="pattern"
    url="assets/markers/pattern-AKA2.patt"
  >
    <!-- 画像はJSで生成 -->
  </a-marker>

  <a-entity camera></a-entity>

</a-scene>

<!-- 画面上の2Dボタン -->
<button id="nextBtn2D">次へ ▶</button>

<script>
let currentIndex = 0;
let isMarkerVisible = false;

const marker = document.getElementById("marker");
const assets = document.getElementById("assets");

const savedImages =
  JSON.parse(localStorage.getItem('arImages')) || [
    "assets/images/sasanooaikon.png",
    "assets/images/tukareta.jpg",
    "assets/images/3.png"
  ];

const imageElements = [];

// 画像生成
savedImages.forEach((src, index) => {
  const assetImg = document.createElement('img');
  assetImg.setAttribute('id', 'img-src-' + index);
  assetImg.setAttribute('src', src);
  assets.appendChild(assetImg);

  const aImg = document.createElement('a-image');
  aImg.setAttribute('src', '#img-src-' + index);
  aImg.setAttribute('rotation', '-90 0 0');
  marker.appendChild(aImg);

  imageElements.push(aImg);
});

// 位置更新
function updateImages() {
  imageElements.forEach((el, index) => {
    let pos, scale;

    if (index === currentIndex) {
      pos = "0 0 0";
      scale = "1.2 1.2 1.2";
    } else if (index < currentIndex) {
      pos = "-1 0 0";
      scale = "0.6 0.6 0.6";
    } else {
      pos = "1 0 0";
      scale = "0.6 0.6 0.6";
    }

    el.setAttribute("position", pos);
    el.setAttribute("scale", scale);
  });
}

marker.addEventListener("markerFound", () => {
  isMarkerVisible = true;
});

marker.addEventListener("markerLost", () => {
  isMarkerVisible = false;
});

// ✅ 2Dボタンで切り替え
document.getElementById("nextBtn2D")
  .addEventListener("click", () => {
    if (!isMarkerVisible) return;

    currentIndex = (currentIndex + 1) % imageElements.length;
    updateImages();
  });

window.addEventListener("load", updateImages);
</script>

</body>
</html>





































